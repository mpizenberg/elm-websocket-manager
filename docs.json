[{"name":"WebSocketManager","comment":" Type-safe WebSocket management with reconnection support via structured ports.\n\n\n# Quick Start\n\n@docs Config, Params, init, initWithParams\n@docs WebSocket, bind, withBinaryPolling, CommandPort, EventPort\n@docs onEvent\n\n\n# Binary (Bytes)\n\n@docs sendBytes\n\n\n# Events\n\n@docs Event, CloseInfo, ReconnectInfo\n\n\n# Close Codes\n\n@docs CloseCode, closeCodeToInt, closeCodeFromInt\n\n\n# Reconnection\n\n@docs ReconnectConfig, defaultReconnect\n\n\n# Connection State\n\n@docs ConnectionState, connectionStateFromEvent\n\n\n# Advanced\n\n@docs Command, encode, eventDecoder\n\n","unions":[{"name":"CloseCode","comment":" RFC 6455 standard close codes plus application-defined custom codes.\n","args":[],"cases":[["Normal",[]],["GoingAway",[]],["ProtocolError",[]],["UnsupportedData",[]],["NoStatus",[]],["AbnormalClosure",[]],["InvalidPayload",[]],["PolicyViolation",[]],["MessageTooBig",[]],["MissingExtension",[]],["InternalError",[]],["ServiceRestart",[]],["TryAgainLater",[]],["CustomCode",["Basics.Int"]]]},{"name":"Command","comment":" Commands that can be sent to the JS WebSocket manager.\n","args":[],"cases":[["Open",[]],["SendText",["String.String"]],["CloseWith",["Maybe.Maybe WebSocketManager.CloseCode","Maybe.Maybe String.String"]]]},{"name":"Config","comment":" Configuration for a WebSocket connection. Opaque — created via `init`.\nThe URL serves as the wire-level identity for the connection.\n","args":[],"cases":[]},{"name":"ConnectionState","comment":" Simple type for tracking the state of a WebSocket connection.\n","args":[],"cases":[["Connecting",[]],["Connected",[]],["Disconnected",["WebSocketManager.CloseInfo"]],["ReconnectingState",["WebSocketManager.ReconnectInfo"]],["Failed",[]]]},{"name":"Event","comment":" Events received from the JS WebSocket manager.\n\n`NoOp` is an internal plumbing event triggered when a fire-and-forget binary\nsend completes (success or failure) or when the binary long-poll is terminated\nby a connection close. It carries no information and can be safely ignored.\n\n","args":[],"cases":[["Opened",[]],["MessageReceived",["String.String"]],["BinaryReceived",["Bytes.Bytes"]],["Closed",["WebSocketManager.CloseInfo"]],["Reconnecting",["WebSocketManager.ReconnectInfo"]],["Reconnected",[]],["ReconnectFailed",[]],["Error",["String.String"]],["NoOp",[]]]}],"aliases":[{"name":"CloseInfo","comment":" Information about a WebSocket close event.\n","args":[],"type":"{ code : WebSocketManager.CloseCode, reason : String.String, wasClean : Basics.Bool }"},{"name":"CommandPort","comment":" Type alias for the outgoing command port signature.\n\n    port wsOut : WebSocketManager.CommandPort msg\n\n","args":["msg"],"type":"Json.Encode.Value -> Platform.Cmd.Cmd msg"},{"name":"EventPort","comment":" Type alias for the incoming event port signature.\n\n    port wsIn : WebSocketManager.EventPort msg\n\n","args":["msg"],"type":"(Json.Decode.Value -> msg) -> Platform.Sub.Sub msg"},{"name":"Params","comment":" Parameters for creating a `Config`.\n","args":[],"type":"{ url : String.String, protocols : List.List String.String, reconnect : Maybe.Maybe WebSocketManager.ReconnectConfig }"},{"name":"ReconnectConfig","comment":" Configuration for automatic reconnection.\n","args":[],"type":"{ maxRetries : Maybe.Maybe Basics.Int, initialDelayMs : Basics.Int, maxDelayMs : Basics.Int, backoffMultiplier : Basics.Float, jitter : Basics.Bool, skipCodes : List.List WebSocketManager.CloseCode }"},{"name":"ReconnectInfo","comment":" Information about a reconnection attempt.\n","args":[],"type":"{ attempt : Basics.Int, nextDelayMs : Basics.Int, maxRetries : Maybe.Maybe Basics.Int }"},{"name":"WebSocket","comment":" A record of ready-to-use command functions bound to a specific connection.\nUse `withBinaryPolling` to wrap your event handler and automatically manage the\nbinary long-poll lifecycle.\n","args":["msg"],"type":"{ open : Platform.Cmd.Cmd msg, sendText : String.String -> Platform.Cmd.Cmd msg, sendBytes : Bytes.Bytes -> Platform.Cmd.Cmd msg, close : Platform.Cmd.Cmd msg, closeWith : Maybe.Maybe WebSocketManager.CloseCode -> Maybe.Maybe String.String -> Platform.Cmd.Cmd msg }"}],"values":[{"name":"bind","comment":" Bind a `Config` to a command port, returning a record of command functions.\nThe `toMsg` constructor routes binary XHR results through your normal event\nhandling. Use `withBinaryPolling` to wrap your event handler.\n\n    echoWs : WS.WebSocket Msg\n    echoWs =\n        WS.bind config wsOut GotWsEvent\n\n","type":"WebSocketManager.Config -> WebSocketManager.CommandPort msg -> (Result.Result Json.Decode.Error WebSocketManager.Event -> msg) -> WebSocketManager.WebSocket msg"},{"name":"closeCodeFromInt","comment":" Convert an integer to a `CloseCode`.\n","type":"Basics.Int -> WebSocketManager.CloseCode"},{"name":"closeCodeToInt","comment":" Convert a `CloseCode` to its integer representation.\n","type":"WebSocketManager.CloseCode -> Basics.Int"},{"name":"connectionStateFromEvent","comment":" Derive a new connection state from an event. Returns `Nothing` for events\nthat don't represent state transitions (like `MessageReceived` or `Error`).\n","type":"WebSocketManager.Event -> Maybe.Maybe WebSocketManager.ConnectionState"},{"name":"defaultReconnect","comment":" Sensible default reconnection configuration.\n\n    { maxRetries = Nothing\n    , initialDelayMs = 1000\n    , maxDelayMs = 300000 -- 5min\n    , backoffMultiplier = 2.0\n    , jitter = True\n    , skipCodes = [ Normal, PolicyViolation ]\n    }\n\n","type":"WebSocketManager.ReconnectConfig"},{"name":"encode","comment":" Encode a command for a given config, ready to be sent through a command port.\n","type":"WebSocketManager.Config -> WebSocketManager.Command -> Json.Encode.Value"},{"name":"eventDecoder","comment":" Decoder for a WebSocket event. Decodes the `tag` field and corresponding payload.\n","type":"Json.Decode.Decoder WebSocketManager.Event"},{"name":"init","comment":" Create a `Config` from a URL with default settings: no sub-protocols\nand default reconnection enabled.\n\n    chatConfig : WS.Config\n    chatConfig =\n        WS.init \"ws://example.com/chat\"\n\n","type":"String.String -> WebSocketManager.Config"},{"name":"initWithParams","comment":" Create a `Config` from full parameters for advanced use cases.\n\n    chatConfig : WS.Config\n    chatConfig =\n        WS.initWithParams\n            { url = \"ws://example.com/chat\"\n            , protocols = [ \"graphql-ws\" ]\n            , reconnect = Nothing\n            }\n\n","type":"WebSocketManager.Params -> WebSocketManager.Config"},{"name":"onEvent","comment":" Subscribe to events from listed connections through a single event port.\nEach config is paired with its own message constructor, so there is no need to\ncompare configs when handling events. The fallback handles decode errors and\nevents that don't match any declared config.\n\n    subscriptions _ =\n        WS.onEvent wsIn\n            [ ( chatConfig, GotChatEvent )\n            , ( notifConfig, GotNotifEvent )\n            ]\n            WsDecodeError\n\n","type":"WebSocketManager.EventPort msg -> List.List ( WebSocketManager.Config, Result.Result Json.Decode.Error WebSocketManager.Event -> msg ) -> (Json.Decode.Error -> msg) -> Platform.Sub.Sub msg"},{"name":"sendBytes","comment":" Send binary data through a WebSocket connection. Uses an XHR monkeypatch\nunder the hood to pass `Bytes` from Elm to JavaScript without JSON encoding.\n\n    WS.sendBytes config payload GotWsEvent\n\n","type":"WebSocketManager.Config -> Bytes.Bytes -> (Result.Result Json.Decode.Error WebSocketManager.Event -> msg) -> Platform.Cmd.Cmd msg"},{"name":"withBinaryPolling","comment":" Wrap your event handler to automatically manage the binary long-poll\nlifecycle. Starts polling on `Opened` and `Reconnected`, re-polls after each\n`BinaryReceived`. Swallows `NoOp` before it reaches your handler.\n\nWorks with both `bind` users and low-level users — only needs the `Config`\nand the same `toMsg` constructor used for event routing.\n\n    GotWsEvent (Ok event) ->\n        WS.withBinaryPolling config GotWsEvent handleEvent event model\n\n","type":"WebSocketManager.Config -> (Result.Result Json.Decode.Error WebSocketManager.Event -> msg) -> (WebSocketManager.Event -> model -> ( model, Platform.Cmd.Cmd msg )) -> WebSocketManager.Event -> model -> ( model, Platform.Cmd.Cmd msg )"}],"binops":[]}]